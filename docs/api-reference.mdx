---
title: "API Reference"
description: "Endpoints for the Attentium x402 Protocol"
---

## Base URL

`https://api.attentium.ai/v1`

---

## Create Campaign

Initialize a verification request. Returns a serialized escrow deposit transaction (402) or campaign keys (200).

<ParamField body="duration" type="integer" required>
  Length of attention needed in seconds (10, 30, 60).
</ParamField>

<ParamField body="quantity" type="integer" required>
  Number of human verifiers needed.
</ParamField>

<ParamField body="bid_per_second" type="float" required>
  USDC amount per second offered. **Minimum: 0.003**.
</ParamField>

<ParamField body="callback_url" type="string">
  Webhook URL to receive results.
</ParamField>

### Required Headers (with payment)

<ParamField header="X-Solana-Tx-Signature" type="string" required>
  The Solana transaction signature of your escrow deposit.
</ParamField>

<ParamField header="X-Agent-Key" type="string" required>
  Your wallet public key (used to derive escrow PDA).
</ParamField>

---

## Payment Flow (Non-Custodial Escrow)

The 402 response includes a **pre-built serialized transaction** for the `deposit_escrow` instruction. Sign and submit it.

### 402 Response

```json
{
  "error": "payment_required",
  "message": "Escrow deposit required: 7.50 USDC",
  "invoice": {
    "amount": 7.50,
    "token": "USDC",
    "transaction": "<base64_serialized_deposit_escrow_tx>",
    "escrow_pda": "<your_escrow_address>"
  }
}
```

### Python Example

```python
import base64
from solana.transaction import Transaction

# Decode the pre-built transaction
serialized_tx = base64.b64decode(invoice["invoice"]["transaction"])
tx = Transaction.from_bytes(serialized_tx)

# Sign with your agent keypair
tx.sign(agent_keypair)

# Submit to Solana
result = client.send_transaction(tx)
tx_signature = str(result.value)
```

> **Non-custodial**: Funds go to an escrow PDA, not a wallet. You retain control of unspent funds.

---

### Example Request (with Payment)

```bash
# Step 1: Get serialized escrow transaction
curl -X POST https://api.attentium.ai/v1/verify \
  -H "Content-Type: application/json" \
  -d '{
    "duration": 30,
    "quantity": 5,
    "bid_per_second": 0.05,
    "validation_question": "Is this a cat?",
    "content_url": "https://example.com/image.png"
  }'
# Returns 402 with serialized transaction

# Step 2: Sign tx, submit to Solana, then verify
curl -X POST https://api.attentium.ai/v1/verify \
  -H "Content-Type: application/json" \
  -H "X-Solana-Tx-Signature: YOUR_ESCROW_TX_SIGNATURE" \
  -H "X-Agent-Key: YOUR_WALLET_PUBKEY" \
  -d '{
    "duration": 30,
    "quantity": 5,
    "bid_per_second": 0.05,
    "validation_question": "Is this a cat?",
    "content_url": "https://example.com/image.png"
  }'
# Returns 200 with campaign keys
```

---

## Fetch Results

Poll for campaign completion status.

<ParamField query="key" type="string" required>
  The read_key returned during creation.
</ParamField>

### Example Request

```bash
curl "https://api.attentium.ai/v1/campaigns/0x123abc/results?key=YOUR_READ_KEY"
```

---

## Claims API

Human workers claim their accumulated USDC earnings via the claims endpoints.

### POST /v1/claims/withdraw

Creates a claim intent and returns an unsigned transaction for the user to sign.

<ParamField body="userPubkey" type="string" required>
  The user's Solana wallet address.
</ParamField>

#### Response

```json
{
  "status": "pending_signature",
  "transaction": "<base64_unsigned_tx>",
  "claimId": "claim_abc123...",
  "amount": 5.25
}
```

---

### POST /v1/claims/submit

Submits a user-signed transaction for broadcast.

<ParamField body="claimId" type="string" required>
  The claimId from the withdraw response.
</ParamField>

<ParamField body="signedTransaction" type="string" required>
  The base64-encoded signed transaction.
</ParamField>

#### Response (Success)

```json
{
  "success": true,
  "txHash": "5abc123...",
  "amount": 5.25
}
```

---

### GET /v1/claims/balance

Returns the user's claimable balance.

<ParamField query="userPubkey" type="string" required>
  The user's Solana wallet address.
</ParamField>

#### Response

```json
{
  "usdc_balance": 5.25,
  "season_points": 150,
  "pending_items": 3
}
```

---

## Agent Refunds

Agents can withdraw unspent escrow funds after campaign completion.

### GET /v1/campaigns/:tx_hash

Returns campaign status and refund transaction if eligible.

#### Response (Refundable)

```json
{
  "status": "expired",
  "escrow_balance": 2.50,
  "refundable": true,
  "withdraw_escrow_tx": "<base64_serialized_withdraw_tx>"
}
```

Sign and submit the `withdraw_escrow_tx` to reclaim your funds.